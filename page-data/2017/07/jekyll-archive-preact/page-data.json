{"componentChunkName":"component---src-templates-blog-post-js","path":"/2017/07/jekyll-archive-preact","result":{"data":{"site":{"siteMetadata":{"title":"saitoxu.io","siteUrl":"https://saitoxu.io"}},"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjElEQVQoz82STQoDIQyF5/5HUVcuFNfeRdyIohvx7xWFllJm2llMaQOPhJiEj8QNF9v21YFjjIc/o+eeQ8LXgne2V7tLWGtFSgnWWhhjVhxjRM4Z3vul3vtnwvujcw6UUhBCoJQCYwxCCEgpobUG5xwhhPMDpy+lLIqpSdxaW4QzP+Pf7vDSK//dx74BXyBi+B0nsZEAAAAASUVORK5CYII=","width":1200,"height":630,"src":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png","srcSet":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png 1x"}}},"markdownRemark":{"id":"a80789d3-2de6-5707-8f94-1d139cc28f57","excerpt":"developit/preactという\nReact から一部機能を除いてサイズを軽くしたライブラリがあります。 この preact を使って、Jekyll で書いてるブログのアーカイブメニューを作ってみた（フッター参照）ので、\n作り方をメモしておきます。 1. アーカイブページを作る jekyll/jekyll…","html":"<p><a href=\"https://github.com/developit/preact/\">developit/preact</a>という\nReact から一部機能を除いてサイズを軽くしたライブラリがあります。</p>\n<p>この preact を使って、Jekyll で書いてるブログのアーカイブメニューを作ってみた（フッター参照）ので、\n作り方をメモしておきます。</p>\n<h2><strong>1. アーカイブページを作る</strong></h2>\n<p><a href=\"https://github.com/jekyll/jekyll-archives\">jekyll/jekyll-archives</a>などを使って、\n<code>https://saitoxu.io/2017/</code>といったアーカイブ用のページを作ります。</p>\n<h2><strong>2. 記事の投稿日付一覧を書き出す</strong></h2>\n<p>記事の投稿日付一覧を DOM に書き出しておきます。\nこれを後で preact で読み込んでアーカイブメニューを作るという流れです。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>archive-data<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ <span class=\"token punctuation\">\"</span></span><span class=\"token attr-name\">{{</span> <span class=\"token attr-name\">site.posts</span> <span class=\"token attr-name\">|</span> <span class=\"token attr-name\"><span class=\"token namespace\">map:</span></span> <span class=\"token attr-name\">'date'</span> <span class=\"token attr-name\">|</span>\n<span class=\"token attr-name\">jsonify</span> <span class=\"token attr-name\">|</span> <span class=\"token attr-name\">escape</span> <span class=\"token attr-name\">\"</span> <span class=\"token attr-name\">}}}}\"</span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>JavaScript で処理しやすいよう<code>jsonify</code>をかませてます。</p>\n<h2><strong>3. preact のセットアップ</strong></h2>\n<p>preact などの npm ライブラリを使う準備をします。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">yarn</span> init\n$ <span class=\"token function\">yarn</span> <span class=\"token function\">install</span> preact watchify babelify babel-preset-es2015 babel-preset-react</code></pre></div>\n<p>preact の環境構築にはこちらが参考になりました。</p>\n<p><a href=\"http://qiita.com/mizchi/items/427713e68e8c980ce0ec\">React サブセット実装の preact で、ライフゲームのアニメーション書いて使い方を確認した</a></p>\n<h2><strong>4. アーカイブメニューのコンポーネント実装</strong></h2>\n<p>アーカイブメニューのコンポーネントを作っていきます。\n大枠は以下のようになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/** @jsx h */</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render<span class=\"token punctuation\">,</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"preact\"</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Archive</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> postDates <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"archive-data\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// postDatesに記事の日付一覧が入ってるのでよしなに使う</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 年の横にあるキャレットをクリック/タップしたときに</span>\n    <span class=\"token comment\">// その年の月別アーカイブを表示/非表示にする処理</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// アーカイブメニューのレンダリング</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DOMContentLoaded\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>Archive <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"archive\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>詳しくは<a href=\"https://github.com/saitoxu/saitoxu.github.io/blob/master/js/index.js\">ソース</a>を見てみてください。</p>\n<h2><strong>おわりに</strong></h2>\n<p>preact を使ってアーカイブメニューを作りました。</p>\n<p>react は大仰だけど、ちょっと使いたいってときに使えるなと思いました。</p>","frontmatter":{"title":"preactを使ってブログのアーカイブメニューを作る","date":"July 01, 2017","tags":["React","JavaScript","Jekyll"],"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABG0lEQVQoz61Sy0rDUBDtx9g8TJrceyFJb16NjdXcig22grSC4kIwSzduxE9w49IvKPgJfohf0O84Jpc2tGKthC4OM8wwhzNzpnVII+wTrY0CiaDTUMafeSNCnSwJWAidBTBovJNAzvxGuGpolEMzezCMAQ4sF22TSygdH6odQLV8aGVUOryeWSfdUKgRH4RmeDr/wMvwE8OkQCJypOISYTqCG2XgyZmMyckFLOeoJA+3rRxDIR44meL9/gvzxwWK/A2n4wlmNwXGV3cQ+RSz2wd4sUA/m4B4qVS7/YZLE0bOM675K5gjoFhdmKwH1j2WiirYbv+fN5TOBmjbroRKeN2rlKyjqu28Yf0m5forh2Wtict//mHjx94DvgFNT2fu89+ymwAAAABJRU5ErkJggg==","width":1200,"height":630,"src":"/static/d48bb187e85caa995cc4fb2066e0fc8a/e7e81/2017-07-01-ogp.png","srcSet":"/static/d48bb187e85caa995cc4fb2066e0fc8a/e7e81/2017-07-01-ogp.png 1x"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2017/07/jekyll-archive-preact","previous":{"fields":{"slug":"/2017/06/react-minesweeper2"},"frontmatter":{"title":"Reactでマインスイーパーを作ってみた②","tags":["React","JavaScript"]}},"next":{"fields":{"slug":"/2017/07/react-native-repro"},"frontmatter":{"title":"React Nativeにアプリ解析ツールのReproを導入してみる","tags":["React Native"]}}}}}