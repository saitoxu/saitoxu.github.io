{"componentChunkName":"component---src-templates-blog-post-js","path":"/2017/05/react-form-data","result":{"data":{"site":{"siteMetadata":{"title":"saitoxu.io","siteUrl":"https://saitoxu.io"}},"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjElEQVQoz82STQoDIQyF5/5HUVcuFNfeRdyIohvx7xWFllJm2llMaQOPhJiEj8QNF9v21YFjjIc/o+eeQ8LXgne2V7tLWGtFSgnWWhhjVhxjRM4Z3vul3vtnwvujcw6UUhBCoJQCYwxCCEgpobUG5xwhhPMDpy+lLIqpSdxaW4QzP+Pf7vDSK//dx74BXyBi+B0nsZEAAAAASUVORK5CYII=","width":1200,"height":630,"src":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png","srcSet":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png 1x"}}},"markdownRemark":{"id":"a8700341-b112-5af4-b9a2-51d34b23cae4","excerpt":"JavaScript でフォームデータを送信する方法のメモです。 FormData オブジェクトを使う FormDataオブジェクトを使ってデータを送信します。\nファイルの送信などに重宝します。 使い方は簡単で、key-value 形式で送信するデータを詰め込むだけです。  詳しくはこちら ↓ FormData…","html":"<p>JavaScript でフォームデータを送信する方法のメモです。</p>\n<h2><strong>FormData オブジェクトを使う</strong></h2>\n<p><code>FormData</code>オブジェクトを使ってデータを送信します。\nファイルの送信などに重宝します。</p>\n<p>使い方は簡単で、key-value 形式で送信するデータを詰め込むだけです。</p>\n<p><div id=\"gist47492826\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-formdata-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-formdata-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-formdata-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>const</span> <span class=pl-s1>fb</span> <span class=pl-c1>=</span> <span class=pl-k>new</span> <span class=pl-v>FormData</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-formdata-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-formdata-js-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-s1>fb</span><span class=pl-kos>.</span><span class=pl-en>append</span><span class=pl-kos>(</span><span class=pl-s>&#39;name&#39;</span><span class=pl-kos>,</span> <span class=pl-s>&#39;saitoxu&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-formdata-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-formdata-js-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-s1>fb</span><span class=pl-kos>.</span><span class=pl-en>append</span><span class=pl-kos>(</span><span class=pl-s>&#39;email&#39;</span><span class=pl-kos>,</span> <span class=pl-s>&#39;saitoxu@example.com&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/saitoxu/7bb93564d4345ed95f61274e9b792b46/raw/cea6d3eb6a1e003b06ad3e284c6611b0e410bc2a/FormData.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/saitoxu/7bb93564d4345ed95f61274e9b792b46#file-formdata-js\">FormData.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>詳しくはこちら ↓</p>\n<ul>\n<li><a href=\"https://developer.mozilla.org/ja/docs/Web/API/FormData\">FormData - Web API インターフェイス | MDN</a></li>\n<li><a href=\"https://developer.mozilla.org/ja/docs/Web/Guide/Using_FormData_Objects\">FormData オブジェクトの利用 - ウェブデベロッパーガイド | MDN</a></li>\n</ul>\n<h2><strong>サンプル</strong></h2>\n<p>React/Rails で使った場合のサンプルを載せておきます。</p>\n<p>クライアントは以下のようになります。\n<code>FormData.append()</code>のキーをサンプルのようにすると、\n通常の Rails のフォームデータ受信と同じようにデータを受け取れます。</p>\n<p><div id=\"gist47492826\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-client-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-client-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-client-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-en>onSubmit</span><span class=pl-kos>(</span><span class=pl-s1>e</span><span class=pl-kos>)</span><span class=pl-kos></span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-client-js-LC2\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-s1>e</span><span class=pl-kos>.</span><span class=pl-en>preventDefault</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-client-js-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>const</span> <span class=pl-s1>fd</span> <span class=pl-c1>=</span> <span class=pl-k>new</span> <span class=pl-v>FormData</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-client-js-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-s1>fd</span><span class=pl-kos>.</span><span class=pl-en>append</span><span class=pl-kos>(</span><span class=pl-s>&#39;user[name]&#39;</span><span class=pl-kos>,</span> <span class=pl-smi>this</span><span class=pl-kos>.</span><span class=pl-c1>state</span><span class=pl-kos>.</span><span class=pl-c1>name</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-client-js-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-s1>fd</span><span class=pl-kos>.</span><span class=pl-en>append</span><span class=pl-kos>(</span><span class=pl-s>&#39;user[email]&#39;</span><span class=pl-kos>,</span> <span class=pl-smi>this</span><span class=pl-kos>.</span><span class=pl-c1>state</span><span class=pl-kos>.</span><span class=pl-c1>email</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-client-js-LC6\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-en>fetch</span><span class=pl-kos>(</span><span class=pl-s>&#39;http://example.com/users&#39;</span><span class=pl-kos>,</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-client-js-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-c1>method</span>: <span class=pl-s>&#39;POST&#39;</span><span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-client-js-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-c1>body</span>: <span class=pl-s1>fd</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-client-js-LC9\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>then</span><span class=pl-kos>(</span><span class=pl-s1>response</span> <span class=pl-c1>=&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-client-js-LC10\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-s1>response</span><span class=pl-kos>.</span><span class=pl-en>json</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-client-js-LC11\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>then</span><span class=pl-kos>(</span><span class=pl-kos>(</span><span class=pl-s1>json</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-client-js-LC12\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-c>// do something</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-client-js-LC13\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>catch</span><span class=pl-kos>(</span><span class=pl-s1>err</span> <span class=pl-c1>=&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-client-js-LC14\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-smi>console</span><span class=pl-kos>.</span><span class=pl-en>log</span><span class=pl-kos>(</span><span class=pl-s1>err</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-client-js-LC15\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-client-js-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-client-js-LC16\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/saitoxu/7bb93564d4345ed95f61274e9b792b46/raw/cea6d3eb6a1e003b06ad3e284c6611b0e410bc2a/Client.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/saitoxu/7bb93564d4345ed95f61274e9b792b46#file-client-js\">Client.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>サーバサイドはこんな感じです。\n通常の Rails と変わったところはないですね。</p>\n<p><div id=\"gist47492826\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-users_controller-rb\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-ruby \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-users_controller-rb-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-users_controller-rb-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>class</span> <span class=pl-v>UsersController</span> &lt; <span class=pl-v>ApplicationController</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-users_controller-rb-LC2\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>def</span> <span class=pl-en>create</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-users_controller-rb-LC3\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-s1>user</span> <span class=pl-c1>=</span> <span class=pl-v>User</span><span class=pl-kos>.</span><span class=pl-en>new</span>(<span class=pl-en>user_params</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-users_controller-rb-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>if</span> <span class=pl-s1>user</span><span class=pl-kos>.</span><span class=pl-en>save</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-users_controller-rb-LC5\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-en>render</span> <span class=pl-pds>json</span>: <span class=pl-kos>{</span> <span class=pl-pds>status</span>: <span class=pl-s>&#39;success&#39;</span> <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-users_controller-rb-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>else</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-users_controller-rb-LC7\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-en>render</span> <span class=pl-pds>json</span>: <span class=pl-kos>{</span> <span class=pl-pds>status</span>: <span class=pl-s>&#39;failure&#39;</span> <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-users_controller-rb-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>end</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-users_controller-rb-LC9\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>end</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-users_controller-rb-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-users_controller-rb-LC11\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>private</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-users_controller-rb-LC12\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-users_controller-rb-LC13\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>def</span> <span class=pl-en>user_params</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-users_controller-rb-LC14\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-en>params</span><span class=pl-kos>.</span><span class=pl-en>require</span>(<span class=pl-pds>:user</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>permit</span>(<span class=pl-pds>:name</span><span class=pl-kos>,</span> <span class=pl-pds>:email</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-users_controller-rb-LC15\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>end</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-users_controller-rb-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-users_controller-rb-LC16\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>end</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/saitoxu/7bb93564d4345ed95f61274e9b792b46/raw/cea6d3eb6a1e003b06ad3e284c6611b0e410bc2a/users_controller.rb\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/saitoxu/7bb93564d4345ed95f61274e9b792b46#file-users_controller-rb\">users_controller.rb</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>","frontmatter":{"title":"JavaScriptでフォームデータを送信する","date":"May 09, 2017","tags":["JavaScript"],"ogp":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2017/05/react-form-data","previous":{"fields":{"slug":"/2017/04/react-minesweeper"},"frontmatter":{"title":"Reactでマインスイーパーを作ってみた","tags":["React","JavaScript"]}},"next":{"fields":{"slug":"/2017/05/rust-inside-ruby"},"frontmatter":{"title":"RubyからRustを呼び出す","tags":["Rust","Ruby"]}}}}}