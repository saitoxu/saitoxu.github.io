{"componentChunkName":"component---src-templates-blog-post-js","path":"/2017/04/react-redux-async","result":{"data":{"site":{"siteMetadata":{"title":"saitoxu.io","siteUrl":"https://saitoxu.io"}},"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjElEQVQoz82STQoDIQyF5/5HUVcuFNfeRdyIohvx7xWFllJm2llMaQOPhJiEj8QNF9v21YFjjIc/o+eeQ8LXgne2V7tLWGtFSgnWWhhjVhxjRM4Z3vul3vtnwvujcw6UUhBCoJQCYwxCCEgpobUG5xwhhPMDpy+lLIqpSdxaW4QzP+Pf7vDSK//dx74BXyBi+B0nsZEAAAAASUVORK5CYII=","width":1200,"height":630,"src":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png","srcSet":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png 1x"}}},"markdownRemark":{"id":"144992bc-d153-5e34-9bcd-ebe0dde9fdf5","excerpt":"Redux 公式のページで紹介されている AJAX を使ったアプリをベースに、\nGitHub の公開リポジトリを取得するアプリを作ってみました。 React Redux Async Sample 動作イメージ ↓ Anime 環境 react 15.5.4 redux 3.6.0 react-redux 5.0.…","html":"<p>Redux 公式のページで紹介されている AJAX を使ったアプリをベースに、\nGitHub の公開リポジトリを取得するアプリを作ってみました。</p>\n<p><a href=\"/playground/react-redux-async-sample/\">React Redux Async Sample</a></p>\n<p>動作イメージ ↓</p>\n<p><img src=\"/ffc58ddfcaca57fb12411095cb99c015/2017-04-16-anime.gif\" alt=\"Anime\"></p>\n<h2><strong>環境</strong></h2>\n<ul>\n<li>react 15.5.4</li>\n<li>redux 3.6.0</li>\n<li>react-redux 5.0.4</li>\n<li>redux-thunk 2.2.0</li>\n</ul>\n<h2><strong>手順</strong></h2>\n<p>大まかなステップだけ説明します。</p>\n<p><strong>1. State を決める</strong></p>\n<p>最初にアプリケーション全体の State を決めます。\n今回は以下のように単純な形でいきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  username<span class=\"token punctuation\">:</span> <span class=\"token string\">\"saitoxu\"</span><span class=\"token punctuation\">,</span>\n  isFetching<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  repos<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"repo1\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"repo2\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"repo3\"</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>2. Action の定義</strong></p>\n<p>Action はリクエストを送るときの<code>REQUEST_REPOS</code>と、\nレスポンスを受け取ったときの<code>RECEIVE_REPOS</code>の 2 種類定義します。</p>\n<p>GitHub の公開リポジトリを取得するのは Fetch API を使いました。</p>\n<p><div id=\"gist46744075\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-actions-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-actions-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-actions-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>export</span> <span class=pl-k>const</span> <span class=pl-c1>REQUEST_REPOS</span> <span class=pl-c1>=</span> <span class=pl-s>&#39;REQUEST_REPOS&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-actions-js-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>export</span> <span class=pl-k>const</span> <span class=pl-c1>RECEIVE_REPOS</span> <span class=pl-c1>=</span> <span class=pl-s>&#39;RECEIVE_REPOS&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-actions-js-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-actions-js-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>export</span> <span class=pl-k>function</span> <span class=pl-en>fetchReposIfNeeded</span><span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-actions-js-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>return</span> <span class=pl-kos>(</span><span class=pl-s1>dispatch</span><span class=pl-kos>,</span> <span class=pl-s1>getState</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-actions-js-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-en>shouldFetchRepos</span><span class=pl-kos>(</span><span class=pl-s1>getState</span><span class=pl-kos>(</span><span class=pl-kos>)</span><span class=pl-kos>,</span> <span class=pl-s1>username</span><span class=pl-kos>)</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-actions-js-LC7\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-k>return</span> <span class=pl-s1>dispatch</span><span class=pl-kos>(</span><span class=pl-en>fetchRepos</span><span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-actions-js-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-actions-js-LC9\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-actions-js-LC10\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-actions-js-LC11\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-actions-js-LC12\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>function</span> <span class=pl-en>fetchRepos</span><span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-actions-js-LC13\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>return</span> <span class=pl-kos>(</span><span class=pl-s1>dispatch</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-actions-js-LC14\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-s1>dispatch</span><span class=pl-kos>(</span><span class=pl-en>requestRepos</span><span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-actions-js-LC15\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>return</span> <span class=pl-en>fetch</span><span class=pl-kos>(</span><span class=pl-s>`https://api.github.com/users/<span class=pl-s1><span class=pl-kos>${</span><span class=pl-s1>username</span><span class=pl-kos>}</span></span>/repos`</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-actions-js-LC16\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-kos>.</span><span class=pl-en>then</span><span class=pl-kos>(</span><span class=pl-kos>(</span><span class=pl-s1>response</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-actions-js-LC17\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>return</span> <span class=pl-s1>response</span><span class=pl-kos>.</span><span class=pl-en>json</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-actions-js-LC18\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-actions-js-LC19\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-kos>.</span><span class=pl-en>then</span><span class=pl-kos>(</span><span class=pl-kos>(</span><span class=pl-s1>json</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-actions-js-LC20\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-s1>json</span><span class=pl-kos>.</span><span class=pl-c1>message</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-actions-js-LC21\" class=\"blob-code blob-code-inner js-file-line\">          <span class=pl-k>throw</span> <span class=pl-v>Error</span><span class=pl-kos>(</span><span class=pl-s1>json</span><span class=pl-kos>.</span><span class=pl-c1>message</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-actions-js-LC22\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-actions-js-LC23\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>return</span> <span class=pl-s1>dispatch</span><span class=pl-kos>(</span><span class=pl-en>receiveRepos</span><span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>,</span> <span class=pl-s1>json</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-actions-js-LC24\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-actions-js-LC25\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-kos>.</span><span class=pl-en>catch</span><span class=pl-kos>(</span><span class=pl-kos>(</span><span class=pl-s1>err</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-actions-js-LC26\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>return</span> <span class=pl-s1>dispatch</span><span class=pl-kos>(</span><span class=pl-en>receiveRepos</span><span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>,</span> <span class=pl-kos>[</span><span class=pl-kos>]</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-actions-js-LC27\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-actions-js-LC28\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-actions-js-LC29\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-actions-js-LC30\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-actions-js-LC31\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>function</span> <span class=pl-en>requestRepos</span><span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-actions-js-LC32\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>return</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-actions-js-LC33\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-c1>type</span>: <span class=pl-c1>REQUEST_REPOS</span><span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-actions-js-LC34\" class=\"blob-code blob-code-inner js-file-line\">    username</td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-actions-js-LC35\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-actions-js-LC36\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-actions-js-LC37\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-actions-js-LC38\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>function</span> <span class=pl-en>receiveRepos</span><span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>,</span> <span class=pl-s1>json</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-actions-js-LC39\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>return</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-actions-js-LC40\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-c1>type</span>: <span class=pl-c1>RECEIVE_REPOS</span><span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"></td>\n        <td id=\"file-actions-js-LC41\" class=\"blob-code blob-code-inner js-file-line\">    username<span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"></td>\n        <td id=\"file-actions-js-LC42\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-c1>repos</span>: <span class=pl-s1>json</span><span class=pl-kos>.</span><span class=pl-en>map</span><span class=pl-kos>(</span><span class=pl-s1>child</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L43\" class=\"blob-num js-line-number\" data-line-number=\"43\"></td>\n        <td id=\"file-actions-js-LC43\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-k>return</span> <span class=pl-kos>{</span> <span class=pl-c1>name</span>: <span class=pl-s1>child</span><span class=pl-kos>.</span><span class=pl-c1>name</span> <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"></td>\n        <td id=\"file-actions-js-LC44\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"></td>\n        <td id=\"file-actions-js-LC45\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"></td>\n        <td id=\"file-actions-js-LC46\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"></td>\n        <td id=\"file-actions-js-LC47\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"></td>\n        <td id=\"file-actions-js-LC48\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>function</span> <span class=pl-en>shouldFetchRepos</span><span class=pl-kos>(</span><span class=pl-s1>state</span><span class=pl-kos>,</span> username <span class=pl-c1>=</span> <span class=pl-s>&#39;&#39;</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"></td>\n        <td id=\"file-actions-js-LC49\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>const</span> <span class=pl-s1>currentUsername</span> <span class=pl-c1>=</span> <span class=pl-s1>state</span><span class=pl-kos>.</span><span class=pl-c1>username</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"></td>\n        <td id=\"file-actions-js-LC50\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>const</span> <span class=pl-s1>isFetching</span> <span class=pl-c1>=</span> <span class=pl-s1>state</span><span class=pl-kos>.</span><span class=pl-c1>isFetching</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"></td>\n        <td id=\"file-actions-js-LC51\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-s1>username</span><span class=pl-kos>.</span><span class=pl-c1>length</span> <span class=pl-c1>===</span> <span class=pl-c1>0</span> <span class=pl-c1>||</span> <span class=pl-s1>currentUsername</span> <span class=pl-c1>===</span> <span class=pl-s1>username</span> <span class=pl-c1>||</span> <span class=pl-s1>isFetching</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"></td>\n        <td id=\"file-actions-js-LC52\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>return</span> <span class=pl-c1>false</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"></td>\n        <td id=\"file-actions-js-LC53\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"></td>\n        <td id=\"file-actions-js-LC54\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>return</span> <span class=pl-c1>true</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-actions-js-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"></td>\n        <td id=\"file-actions-js-LC55\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/saitoxu/705e41267e50dee76d28eb98849edd90/raw/9c2548c4e04dd84642a423e5ac0ecb7d4b6602d8/actions.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/saitoxu/705e41267e50dee76d28eb98849edd90#file-actions-js\">actions.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p><strong>3. Reducer を作る</strong></p>\n<p>次に、Reducer を作ります。\n今回は State が単純なので、Reducer は 1 つだけで OK です。</p>\n<p><div id=\"gist46744075\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-reducers-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-reducers-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-reducers-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>import</span> <span class=pl-kos>{</span> <span class=pl-s1>combineReducers</span> <span class=pl-kos>}</span> <span class=pl-k>from</span> <span class=pl-s>&#39;redux&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-reducers-js-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>import</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-reducers-js-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-c1>REQUEST_REPOS</span><span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-reducers-js-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-c1>RECEIVE_REPOS</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-reducers-js-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span> <span class=pl-k>from</span> <span class=pl-s>&#39;./actions&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-reducers-js-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-reducers-js-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>function</span> <span class=pl-en>reposByUser</span><span class=pl-kos>(</span>state <span class=pl-c1>=</span> <span class=pl-kos>{</span> <span class=pl-c1>username</span>: <span class=pl-s>&#39;&#39;</span><span class=pl-kos>,</span> <span class=pl-c1>isFetching</span>: <span class=pl-c1>false</span><span class=pl-kos>,</span> <span class=pl-c1>repos</span>: <span class=pl-kos>[</span><span class=pl-kos>]</span> <span class=pl-kos>}</span><span class=pl-kos>,</span> <span class=pl-s1>action</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-reducers-js-LC8\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>switch</span> <span class=pl-kos>(</span><span class=pl-s1>action</span><span class=pl-kos>.</span><span class=pl-c1>type</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-reducers-js-LC9\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>case</span> <span class=pl-c1>REQUEST_REPOS</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-reducers-js-LC10\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-k>return</span> <span class=pl-v>Object</span><span class=pl-kos>.</span><span class=pl-en>assign</span><span class=pl-kos>(</span><span class=pl-kos>{</span><span class=pl-kos>}</span><span class=pl-kos>,</span> <span class=pl-s1>state</span><span class=pl-kos>,</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-reducers-js-LC11\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-c1>username</span>: <span class=pl-s1>action</span><span class=pl-kos>.</span><span class=pl-c1>username</span><span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-reducers-js-LC12\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-c1>isFetching</span>: <span class=pl-c1>true</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-reducers-js-LC13\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-reducers-js-LC14\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>case</span> <span class=pl-c1>RECEIVE_REPOS</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-reducers-js-LC15\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-k>return</span> <span class=pl-v>Object</span><span class=pl-kos>.</span><span class=pl-en>assign</span><span class=pl-kos>(</span><span class=pl-kos>{</span><span class=pl-kos>}</span><span class=pl-kos>,</span> <span class=pl-s1>state</span><span class=pl-kos>,</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-reducers-js-LC16\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-c1>isFetching</span>: <span class=pl-c1>false</span><span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-reducers-js-LC17\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-c1>repos</span>: <span class=pl-s1>action</span><span class=pl-kos>.</span><span class=pl-c1>repos</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-reducers-js-LC18\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-reducers-js-LC19\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-k>default</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-reducers-js-LC20\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-k>return</span> <span class=pl-s1>state</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-reducers-js-LC21\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-reducers-js-LC22\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-reducers-js-LC23\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-reducers-js-LC24\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>const</span> <span class=pl-s1>rootReducer</span> <span class=pl-c1>=</span> <span class=pl-en>combineReducers</span><span class=pl-kos>(</span><span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-reducers-js-LC25\" class=\"blob-code blob-code-inner js-file-line\">  reposByUser</td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-reducers-js-LC26\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-reducers-js-LC27\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-reducers-js-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-reducers-js-LC28\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>export</span> <span class=pl-k>default</span> <span class=pl-s1>rootReducer</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/saitoxu/705e41267e50dee76d28eb98849edd90/raw/9c2548c4e04dd84642a423e5ac0ecb7d4b6602d8/reducers.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/saitoxu/705e41267e50dee76d28eb98849edd90#file-reducers-js\">reducers.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p><strong>4. Store を作る</strong></p>\n<p>Reducer から Store を作るのは簡単です。\n非同期リクエストを扱うので、redux-thunk で提供されている<code>thunkMiddleware</code>をかませます。</p>\n<p><div id=\"gist46744075\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-configurestore-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-configurestore-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-configurestore-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>import</span> <span class=pl-kos>{</span> <span class=pl-s1>createStore</span><span class=pl-kos>,</span> <span class=pl-s1>applyMiddleware</span> <span class=pl-kos>}</span> <span class=pl-k>from</span> <span class=pl-s>&#39;redux&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-configurestore-js-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>import</span> <span class=pl-s1>thunkMiddleware</span> <span class=pl-k>from</span> <span class=pl-s>&#39;redux-thunk&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-configurestore-js-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>import</span> <span class=pl-s1>rootReducer</span> <span class=pl-k>from</span> <span class=pl-s>&#39;./reducers&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-configurestore-js-LC4\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-configurestore-js-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-k>export</span> <span class=pl-k>default</span> <span class=pl-k>function</span> <span class=pl-en>configureStore</span><span class=pl-kos>(</span><span class=pl-s1>preloadedState</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-configurestore-js-LC6\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-k>return</span> <span class=pl-en>createStore</span><span class=pl-kos>(</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-configurestore-js-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-s1>rootReducer</span><span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-configurestore-js-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-s1>preloadedState</span><span class=pl-kos>,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-configurestore-js-LC9\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-en>applyMiddleware</span><span class=pl-kos>(</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-configurestore-js-LC10\" class=\"blob-code blob-code-inner js-file-line\">      <span class=pl-s1>thunkMiddleware</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-configurestore-js-LC11\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-configurestore-js-LC12\" class=\"blob-code blob-code-inner js-file-line\">  <span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-configurestore-js-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-configurestore-js-LC13\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>}</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/saitoxu/705e41267e50dee76d28eb98849edd90/raw/9c2548c4e04dd84642a423e5ac0ecb7d4b6602d8/configureStore.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/saitoxu/705e41267e50dee76d28eb98849edd90#file-configurestore-js\">configureStore.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>残りは<a href=\"https://gist.github.com/saitoxu/705e41267e50dee76d28eb98849edd90\">Gist</a>にあげているので確認してみてください。</p>","frontmatter":{"title":"React+ReduxでAJAXを使ったアプリを作ってみる","date":"April 16, 2017","tags":["React","Redux","JavaScript"],"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAA6UlEQVQoz62SXwuCMBTF/dw+CD76Aeqz9NaDEvTUQw+BJfSHEDRnKW5uS066WEmZFDn4cbfL5ezsMKMsSwyJ0T4wxh5V0+7/JdjuUUoVet932ZugHqDFc9+sqqogpVSVc67oct7pkFKG5SxEuDtDSA7P8xAEAaIogu/7yLIMeZ73O1TuaiFZcRw2BPPJHovpEZdzjvF4BNM04TgOLMuCbdtwXVc51xF0CN5FuShxCjNsVwkOa4KioDUFCCFI0xRJkiCOY+XyNaa3J+sBUYs2TuWVq16TlxDiQZPlTxnq5yvYZ75yOOjHHoIbCLROmroijuIAAAAASUVORK5CYII=","width":1200,"height":630,"src":"/static/f1b12cf616a896286f23da9f20d71706/e7e81/2017-04-16-ogp.png","srcSet":"/static/f1b12cf616a896286f23da9f20d71706/e7e81/2017-04-16-ogp.png 1x"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2017/04/react-redux-async","previous":{"fields":{"slug":"/2017/04/react-on-rails"},"frontmatter":{"title":"React on Railsの環境構築手順","tags":["Rails","React"]}},"next":{"fields":{"slug":"/2017/04/react-minesweeper"},"frontmatter":{"title":"Reactでマインスイーパーを作ってみた","tags":["React","JavaScript"]}}}}}