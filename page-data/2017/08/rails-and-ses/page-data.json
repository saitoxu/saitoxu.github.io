{"componentChunkName":"component---src-templates-blog-post-js","path":"/2017/08/rails-and-ses","result":{"data":{"site":{"siteMetadata":{"title":"saitoxu.io","siteUrl":"https://saitoxu.io"}},"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjElEQVQoz82STQoDIQyF5/5HUVcuFNfeRdyIohvx7xWFllJm2llMaQOPhJiEj8QNF9v21YFjjIc/o+eeQ8LXgne2V7tLWGtFSgnWWhhjVhxjRM4Z3vul3vtnwvujcw6UUhBCoJQCYwxCCEgpobUG5xwhhPMDpy+lLIqpSdxaW4QzP+Pf7vDSK//dx74BXyBi+B0nsZEAAAAASUVORK5CYII=","width":1200,"height":630,"src":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png","srcSet":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png 1x"}}},"markdownRemark":{"id":"21c40ed0-5ad3-57b0-bf88-17db08018bd9","excerpt":"Rails と Amazon SES を使ったシステムで、\nメールをなるべく確実に届ける方法について調べました。 メールを確実に届けるには？ メールの到達率を上げるには次のことに気をつけなければなりません。 レピュテーション インフラ 認証 これらについて、Rails と SES…","html":"<p>Rails と Amazon SES を使ったシステムで、\nメールをなるべく確実に届ける方法について調べました。</p>\n<h2><strong>メールを確実に届けるには？</strong></h2>\n<p>メールの到達率を上げるには次のことに気をつけなければなりません。</p>\n<ol>\n<li>レピュテーション</li>\n<li>インフラ</li>\n<li>認証</li>\n</ol>\n<p>これらについて、Rails と SES を使う場合にどこに気をつけるべきか見ていきたいと思います。</p>\n<h2><strong>1. レピュテーション</strong></h2>\n<p>レピュテーションを落とさないためにはバウンス率と苦情の数に気をつける必要があります。</p>\n<blockquote>\n<p>バウンスとはメールアドレスが間違っていた場合や、配信先のメールサーバがダウンしていたなどの理由によりメールが配信されないこと。\n苦情はメールがスパムとして報告されること</p>\n</blockquote>\n<p>SES ではバウンスや苦情があった場合、Amazon SNS を介して通知してくれます。\nこれを使ってバウンスや苦情のあったメールアドレスを管理し、\nそういったメールアドレスには送らないようにすることでバウンス率・苦情の数を低く抑えることができます。</p>\n<p>実装は、一例ですが次の記事が参考になります。</p>\n<p><a href=\"http://kinosuke.hatenablog.jp/entry/2016/03/03/200846\">Rails×SES バウンスメール（不達メール）対策</a></p>\n<p>また、バウンス率や苦情の割合は API 経由でも取得できるので、\n観測しておいて上昇してきたら対策を講じるのも手です。</p>\n<h2><strong>2. インフラ</strong></h2>\n<p>メール配信のインフラで気をつける点は、</p>\n<ul>\n<li>メールサーバをセキュアな構成にする</li>\n<li>固定 IP を使って配信する</li>\n</ul>\n<p>などがありますが、この辺は SES が面倒を見てくれます。</p>\n<p>ユーザとしてできることとして、配信するメールアドレスは\npostmaster や abuse などのアカウントで <strong>受信もできるようにしておく</strong> と良いでしょう。</p>\n<p>自分は Amazon Lambda と以下のスクリプトを使って、\npostmaster 宛てのメールを自分のメールアドレスに転送するようにしました。</p>\n<p><a href=\"https://github.com/arithmetric/aws-lambda-ses-forwarder\">arithmetric/aws-lambda-ses-forwarder</a></p>\n<h2><strong>3. 認証</strong></h2>\n<p>送信者認証(SPF)やドメイン電子署名(DKIM)を利用するようにしましょう。</p>\n<p>こちらの記事などが参考になります。</p>\n<p><a href=\"http://dev.classmethod.jp/cloud/amazon-ses-production/\">Amazon SES で SPF と DKIM を用いて高信頼なメールを送る</a></p>\n<h2><strong>おわりに</strong></h2>\n<p>以上、Rails と SES を使うときにメールの到達率を向上させる方法についてまとめました（終わってみたらあまり Rails とは関係ない内容になりました笑）。</p>\n<p>調査中、以下のページがたいへん参考になりました。</p>\n<p><a href=\"https://sendgrid.kke.co.jp/guide/email-deliverability-guide-%EF%BD%9E%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%92%E7%A2%BA%E5%AE%9F%E3%81%AB%E5%B1%8A%E3%81%91%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AB%EF%BD%9E/\">Email Deliverability Guide ～メールを確実に届けるために～</a></p>","frontmatter":{"title":"RailsとAmazon SESを使ってメールを確実に届けるには","date":"August 14, 2017","tags":["Rails","Amazon SES"],"ogp":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2017/08/rails-and-ses","previous":{"fields":{"slug":"/2017/08/webview-ats-error"},"frontmatter":{"title":"ATSで許可されていないhttpなURLへの対処方法","tags":["React Native"]}},"next":{"fields":{"slug":"/2017/08/instagram-clone"},"frontmatter":{"title":"React NativeでInstagramのクローンを作ってみた","tags":["React Native"]}}}}}