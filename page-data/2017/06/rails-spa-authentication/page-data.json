{"componentChunkName":"component---src-templates-blog-post-js","path":"/2017/06/rails-spa-authentication","result":{"data":{"site":{"siteMetadata":{"title":"saitoxu.io","siteUrl":"https://saitoxu.io"}},"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjElEQVQoz82STQoDIQyF5/5HUVcuFNfeRdyIohvx7xWFllJm2llMaQOPhJiEj8QNF9v21YFjjIc/o+eeQ8LXgne2V7tLWGtFSgnWWhhjVhxjRM4Z3vul3vtnwvujcw6UUhBCoJQCYwxCCEgpobUG5xwhhPMDpy+lLIqpSdxaW4QzP+Pf7vDSK//dx74BXyBi+B0nsZEAAAAASUVORK5CYII=","width":1200,"height":630,"src":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png","srcSet":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png 1x"}}},"markdownRemark":{"id":"9a843e3f-3fd6-5285-a4de-85db6f714a83","excerpt":"Rails×SPA での認証方法は何がベストなんだろうと思って、調べたことをまとめておきます。 SPA での認証方法 SPA での認証方法はざっと調べたところ以下の 3 種類に集約できそうです。 JWT トークン セッション × クッキー それぞれの Pros/Cons を以下で考えてみます。 1. JWT Json…","html":"<p>Rails×SPA での認証方法は何がベストなんだろうと思って、調べたことをまとめておきます。</p>\n<h2><strong>SPA での認証方法</strong></h2>\n<p>SPA での認証方法はざっと調べたところ以下の 3 種類に集約できそうです。</p>\n<ol>\n<li>JWT</li>\n<li>トークン</li>\n<li>セッション × クッキー</li>\n</ol>\n<p>それぞれの Pros/Cons を以下で考えてみます。</p>\n<h2><strong>1. JWT</strong></h2>\n<p>Json Web Token を使って認証する方法です。\nJWT の改ざんできない性質を使って本人かどうかを認証します。</p>\n<p><strong>Pros</strong></p>\n<ul>\n<li>JWT の payload 部分にユーザ情報などを含められるので、セッション不要 → スケーラビリティ高</li>\n<li>シングルサインオンとかに使える模様 →<a href=\"https://www.slideshare.net/TsuchiKazu/jwt-ssopepabotech\">JWT を使った簡易 SSO で徐々にシステムをリニューアルしている話</a></li>\n<li><a href=\"https://github.com/nsarno/knock\">knock</a>という Rails で JWT 認証を扱う gem がある</li>\n</ul>\n<p><strong>Cons</strong></p>\n<ul>\n<li>署名のための鍵の管理をしないといけない</li>\n<li><a href=\"https://github.com/plataformatec/devise\">devise</a>的な、認証周りの面倒をまるっと見てくれる gem がなくてめんどそう</li>\n</ul>\n<h2><strong>2. トークン</strong></h2>\n<p>トークン認証は推測されにくい適当な文字列をユーザ毎に生成して、\nそれを HTTP ヘッダーなどに含めて一致不一致で認証するものです。</p>\n<p><strong>Pros</strong></p>\n<ul>\n<li>セッション非依存なので、アプリケーションサーバを増やすのは簡単</li>\n<li><a href=\"https://github.com/lynndylanhurley/devise_token_auth\">devise<em>token</em>auth</a>という devise のトークン認証版 gem があってさっと使える</li>\n</ul>\n<p><strong>Cons</strong></p>\n<ul>\n<li>DB アクセスが増える（トークンを DB に保存する場合）</li>\n<li>devise<em>token</em>auth のカスタマイズがめんどう</li>\n</ul>\n<h2><strong>3. セッション × クッキー</strong></h2>\n<p>セッションとクッキーを使ったプリミティブな認証方法です。</p>\n<p><strong>Pros</strong></p>\n<ul>\n<li>devise とか古くからある認証のための gem が使える（試してないのであれですが）</li>\n</ul>\n<p><strong>Cons</strong></p>\n<ul>\n<li>アプリケーションサーバに紐づくのでスケールさせづらい。セッションストレージを外に持たすのもできるがそれはそれでめんどう</li>\n<li>CSRF Token の付与をどうするか考えないといけない（JWT・トークン認証も実装によっては考える必要があります）</li>\n</ul>\n<h2><strong>まとめ</strong></h2>\n<p>以上、SPA on Rails の認証方法について調べたことを書いてみました。</p>\n<p>個人的には、JWT 認証が融通が効きそうで良いかなと思いましたが、認証機能の周辺（確認メールとかパスワードリセットとか）を作るのがめんどうですかね。</p>\n<p>その点、devise<em>token</em>auth はその辺は用意されているので、要件によってはこっちでも良いなと思います。</p>","frontmatter":{"title":"RailsにおけるSPAの認証方法について","date":"June 17, 2017","tags":["Rails","React"],"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABiUlEQVQoz42Sy07bQBSG84Is+g7wAKhr3qAbdiwqFkh0UYqAJVIFReqFcImNnRgHQkmcSDFBSkIuxs545mOSYOQEQ3ukM3N0Lr/+c8mRIUqp8TOx426X9tY3gmIRFYZJwjQnQ3IzIKlfxjFCSqJOh97JCQPLYtTrIbRfan9WzQxgEkiCXc2s7LpUPY+q79No3XN1fY1hGATB8FX+GwzVc6fTxFgqzUYhomCi8Zi1iFFzYJkM54OTAjlAjTwY3WqtaLuGEk2keJhhmCaZAkyBSaGLG8SPDv2Ow71/SbNua7tMOKhov4uK+5lt5+bnN45JzaLftvH+ujh6Ic7RAYUfh1jnecq2gV+/QIQ1kmN4B3A6v2h4S+nPMZeWyWn5K79Ka5wWt7hxK1wd29wYJlHgvcz8n4DNVp6f5jrbF4sUm7sMwy756md27CX27GW+l1Y0oPM/LU/vq9DYYNNa4Iv5gXr7jIfBHYXaJvnGKr/rn9ivfMTvmc918v07TETIkJHUp6Ii3pKXJaZ8T/JoTC5zOn+0AAAAAElFTkSuQmCC","width":1200,"height":630,"src":"/static/6c0d1cf1d95e4c66efb20736251573fe/e7e81/2017-06-17-ogp.png","srcSet":"/static/6c0d1cf1d95e4c66efb20736251573fe/e7e81/2017-06-17-ogp.png 1x"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2017/06/rails-spa-authentication","previous":{"fields":{"slug":"/2017/06/google-cloud-vision-ocr"},"frontmatter":{"title":"Google Cloud VisionでOCR","tags":["Google Cloud"]}},"next":{"fields":{"slug":"/2017/06/react-minesweeper2"},"frontmatter":{"title":"Reactでマインスイーパーを作ってみた②","tags":["React","JavaScript"]}}}}}