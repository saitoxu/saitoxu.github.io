{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016/11/how-to-create-excel-by-apache-poi","result":{"data":{"site":{"siteMetadata":{"title":"saitoxu.io","siteUrl":"https://saitoxu.io"}},"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjElEQVQoz82STQoDIQyF5/5HUVcuFNfeRdyIohvx7xWFllJm2llMaQOPhJiEj8QNF9v21YFjjIc/o+eeQ8LXgne2V7tLWGtFSgnWWhhjVhxjRM4Z3vul3vtnwvujcw6UUhBCoJQCYwxCCEgpobUG5xwhhPMDpy+lLIqpSdxaW4QzP+Pf7vDSK//dx74BXyBi+B0nsZEAAAAASUVORK5CYII=","width":1200,"height":630,"src":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png","srcSet":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png 1x"}}},"markdownRemark":{"id":"cda9dd82-f6c3-5ff2-9838-934be8e07fe1","excerpt":"I often use Apache POI to deal with Microsoft Office in these days. Today I introduce how to create Excel file by using Apache POI. Let’s create the following…","html":"<p>I often use Apache POI to deal with Microsoft Office in these days.</p>\n<p>Today I introduce how to create Excel file by using Apache POI.</p>\n<p>Let’s create the following Excel file.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 347px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dcd9d6277d2e22def8d17c8250b9d156/72a90/2016-11-01-sample-excel.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.71757925072046%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAAA80lEQVQY02VQy0rFMBTM/3+EG3/ApQrqtQjSa930YV/pgy4EF2opTdI0j+u0gSD3DuEwTM6ccxii1MrY3Pe9EELKZRzHNE2TOI6i6O14LMsyjuMwDCmtkyRblkX8AwmCl9u7h8Nz8Ph0oLTJsqzZked5Q5u2baFgRNd1RVFUVYU1FJPqehgGcnV9c//6032y93L6+pWnk1FKaa2NtdqYdV3NDoio0L0CkI+8nLhhi/meFBertZvBtaL6Viml3uEJQHCANRrP6K3XbQPwB/Ol59wMg973ANZaR86OvCTb2cjWRcc5Z4whT1Rwr7hfT+Z59mn/AYapiYJMgSHoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Sample Excel\"\n        title=\"Sample Excel\"\n        src=\"/static/dcd9d6277d2e22def8d17c8250b9d156/72a90/2016-11-01-sample-excel.png\"\n        srcset=\"/static/dcd9d6277d2e22def8d17c8250b9d156/00d96/2016-11-01-sample-excel.png 148w,\n/static/dcd9d6277d2e22def8d17c8250b9d156/0b23c/2016-11-01-sample-excel.png 295w,\n/static/dcd9d6277d2e22def8d17c8250b9d156/72a90/2016-11-01-sample-excel.png 347w\"\n        sizes=\"(max-width: 347px) 100vw, 347px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Please refer <a href=\"/2016/10/how-to-create-powerpoint-via-poi\">a previous article</a>\nfor install of Apache POI.</p>\n<h4><strong>Step 1</strong></h4>\n<p>At first, create <code>XSSFWorkBook</code> object to represent work book of Excel,\nand create <code>FileOutputStream</code> to write the Excel file too.</p>\n<p>In this sample, use ”auto close feature” from Java7.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">XSSFWorkbook</span> book <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token class-name\">FileOutputStream</span> out <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// write code here</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4><strong>Step 2</strong></h4>\n<p>Create a sheet.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4><strong>Step 3</strong></h4>\n<p>Specify a cell to write content.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4><strong>Step 4</strong></h4>\n<p>Specify a format.</p>\n<p>There are a lot of options except below, please search others.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">CellStyle</span> style <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Font</span> font <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfont<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span>BLUE<span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nstyle<span class=\"token punctuation\">.</span><span class=\"token function\">setWrapText</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nstyle<span class=\"token punctuation\">.</span><span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4><strong>Step 5</strong></h4>\n<p>Write value to the cell.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4><strong>Step 6</strong></h4>\n<p>Finally, write the book to a file.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">book<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Overall source code is below.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>saitoxu<span class=\"token punctuation\">.</span>poisample</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>poi<span class=\"token punctuation\">.</span>ss<span class=\"token punctuation\">.</span>usermodel</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Cell</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>poi<span class=\"token punctuation\">.</span>ss<span class=\"token punctuation\">.</span>usermodel</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">CellStyle</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>poi<span class=\"token punctuation\">.</span>ss<span class=\"token punctuation\">.</span>usermodel</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Font</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>poi<span class=\"token punctuation\">.</span>ss<span class=\"token punctuation\">.</span>usermodel</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>poi<span class=\"token punctuation\">.</span>ss<span class=\"token punctuation\">.</span>usermodel</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Row</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>poi<span class=\"token punctuation\">.</span>ss<span class=\"token punctuation\">.</span>usermodel</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Sheet</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>poi<span class=\"token punctuation\">.</span>xssf<span class=\"token punctuation\">.</span>usermodel</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">XSSFWorkbook</span> book <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XSSFWorkbook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">FileOutputStream</span> out <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.xlsx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">Sheet</span> sheet <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span><span class=\"token function\">createSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token class-name\">Row</span> row <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">createRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Cell</span> cell <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span><span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token class-name\">CellStyle</span> style <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span><span class=\"token function\">createCellStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Font</span> font <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span><span class=\"token function\">createFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            font<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IndexedColors</span><span class=\"token punctuation\">.</span>BLUE<span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            style<span class=\"token punctuation\">.</span><span class=\"token function\">setWrapText</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            style<span class=\"token punctuation\">.</span><span class=\"token function\">setFont</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellStyle</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            cell<span class=\"token punctuation\">.</span><span class=\"token function\">setCellValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            book<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"How to create Excel by Apache POI","date":"November 01, 2016","tags":["POI","Java","Excel"],"ogp":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2016/11/how-to-create-excel-by-apache-poi","previous":{"fields":{"slug":"/2016/10/how-to-use-gulp-watch"},"frontmatter":{"title":"How to use Gulp \"watch\"","tags":["Gulp","JavaScript","Sass","SCSS"]}},"next":{"fields":{"slug":"/2016/11/inductive-learning"},"frontmatter":{"title":"Inductive Learning","tags":["JavaScript","Machine Learning"]}}}}}