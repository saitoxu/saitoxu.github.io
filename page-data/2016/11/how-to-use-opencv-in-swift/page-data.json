{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016/11/how-to-use-opencv-in-swift","result":{"data":{"site":{"siteMetadata":{"title":"saitoxu.io","siteUrl":"https://saitoxu.io"}},"ogp":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjElEQVQoz82STQoDIQyF5/5HUVcuFNfeRdyIohvx7xWFllJm2llMaQOPhJiEj8QNF9v21YFjjIc/o+eeQ8LXgne2V7tLWGtFSgnWWhhjVhxjRM4Z3vul3vtnwvujcw6UUhBCoJQCYwxCCEgpobUG5xwhhPMDpy+lLIqpSdxaW4QzP+Pf7vDSK//dx74BXyBi+B0nsZEAAAAASUVORK5CYII=","width":1200,"height":630,"src":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png","srcSet":"/static/bb302f3ca7aabb14b0ae74df1c534526/e7e81/ogp.png 1x"}}},"markdownRemark":{"id":"e6386cde-5d6e-500b-8f69-efdc0e918e37","excerpt":"I try to use OpenCV library in Swift today. Let’s convert an picture by camera to a black-and-white image. Environment iOS9.3.4 Xcode8.1 (Swift3.0.1) OpenCV (…","html":"<p>I try to use OpenCV library in Swift today.</p>\n<p>Let’s convert an picture by camera to a black-and-white image.</p>\n<h4><strong>Environment</strong></h4>\n<ul>\n<li>iOS9.3.4</li>\n<li>Xcode8.1 (Swift3.0.1)</li>\n<li>OpenCV (3.1.0.1)</li>\n</ul>\n<h4><strong>Step 1</strong></h4>\n<p>First, create a project in Xcode,\nand do <code>pod init</code> at the project top directory.</p>\n<p>After that, edit <code>Podfile</code> like this.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">platform <span class=\"token symbol\">:ios</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'9.0'</span>\n\ntarget <span class=\"token string\">'OpenCVTest'</span> <span class=\"token keyword\">do</span>\n  use_frameworks<span class=\"token operator\">!</span>\n  pod <span class=\"token string\">'OpenCV'</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>And, install OpenCV library by <code>pod install</code> and open the project.</p>\n<h4><strong>Step 2</strong></h4>\n<p>Put an image view and a button on the first view.</p>\n<p>The image view is for showing an image of camera,\nand the button is for taking a shot.</p>\n<p>After putting, storyboard is like this.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bc0eaf387e92768b68fc3bdbadf69dc4/7a2f6/2016-11-06-storyboard.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.096926713948%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAAClklEQVQ4y4WSbU/aUBTH+z1A55YsGZY+l0ehQvbRVKZTnMa92Mt9g73QKWzvt4igxiVONwgqtGq1T7QU2t7e7oITmcuyf06a09P7u+d/Ty+mqmq3a8uyrCiKYRiqouiapijqnTRNUxUVVTq6bhpq4APoAx8A34dOr4NZHUU8P2mLlwgLxuRDOMovZKtWvz34IdZOryonVx2rh4roO4ael1K7ddFCzR3HCWwUfWj3fd0KXO9ug8OG8uHL+VZF3Nxtb1XamumM4OBG7160JMfpB8B365J7UPcaknPUAJICboxAM7/Vb7f22qWquFMVyzVRt0aw25OazZYk92x75BM1RIdDCTDtoHraeFdGcLkm7Qz5Bxi6TkeWTMuyTBMAcE9D4IHg/tiHp9fI8Kd9qfQIvl880PjA7joPi/CoqW7utko1cbsqlv6GHwtCHxk2e9D10NtRy9isSuV9EfGl2v9g1NA5PnP3f3otOTCs46/1ndL37Ur74564vSdqI3j4z5HHgRDj/w7fQ7cBQs8HTscyjs9u3n9uN+VL3b5WzF7fAd5A2MOQ/hSaoK7plml1bduBgzUIgMNBDK6Q77uui21srL9dK66+WSsWVxbn51YX5tcXC6sLhYW5uVeFwkqxuIy09Hqo5WEMkkFtaQmjGfb5VCiJP2EjT3manJnJEER0emoy+mxqcmIiFAqFx2Jc4XAYy+VzDE0JCSabTgi5vJBJ8yzF0CTHUjxHcyzNs3ScQ08KJSRJEmPCMpkMgUeyPJ5OcOmskJnNCfmXwuwsx9A4HsGnI5EX/xSWFQSSiKY4Ih1nEolYKpVIJePJOMcyJE0RHEPiaIPpceGjQLbzMZZJchRHETxSLB7jkUEqSlDRKIlHkU/qX/EL70fDFKIDq/IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Storyboard\"\n        title=\"Storyboard\"\n        src=\"/static/bc0eaf387e92768b68fc3bdbadf69dc4/799d3/2016-11-06-storyboard.png\"\n        srcset=\"/static/bc0eaf387e92768b68fc3bdbadf69dc4/00d96/2016-11-06-storyboard.png 148w,\n/static/bc0eaf387e92768b68fc3bdbadf69dc4/0b23c/2016-11-06-storyboard.png 295w,\n/static/bc0eaf387e92768b68fc3bdbadf69dc4/799d3/2016-11-06-storyboard.png 590w,\n/static/bc0eaf387e92768b68fc3bdbadf69dc4/7a2f6/2016-11-06-storyboard.png 846w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h4><strong>Step 3</strong></h4>\n<p>Next, get the backside camera device,\nand show its image in the image view you prepared.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token comment\">// ViewController.swift</span>\n<span class=\"token keyword\">import</span> <span class=\"token builtin\">UIKit</span>\n<span class=\"token keyword\">import</span> <span class=\"token builtin\">AVFoundation</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">AVCaptureVideoDataOutputSampleBufferDelegate</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token atrule\">@IBOutlet</span> <span class=\"token keyword\">weak</span> <span class=\"token keyword\">var</span> imageView<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIImageView</span><span class=\"token operator\">!</span>\n\n    <span class=\"token keyword\">var</span> session <span class=\"token punctuation\">:</span> <span class=\"token builtin\">AVCaptureSession</span><span class=\"token operator\">!</span>\n    <span class=\"token keyword\">var</span> device <span class=\"token punctuation\">:</span> <span class=\"token builtin\">AVCaptureDevice</span><span class=\"token operator\">!</span>\n    <span class=\"token keyword\">var</span> output <span class=\"token punctuation\">:</span> <span class=\"token builtin\">AVCaptureVideoDataOutput</span><span class=\"token operator\">!</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// Do any additional setup after loading the view, typically from a nib.</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token function\">initCamera</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            session<span class=\"token punctuation\">.</span><span class=\"token function\">startRunning</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function\">didReceiveMemoryWarning</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">didReceiveMemoryWarning</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// Dispose of any resources that can be recreated.</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token atrule\">@IBAction</span> <span class=\"token keyword\">func</span> <span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> sender<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// when button is tapped, this method is called</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">initCamera</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">Bool</span> <span class=\"token punctuation\">{</span>\n        session <span class=\"token operator\">=</span> <span class=\"token function\">AVCaptureSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        session<span class=\"token punctuation\">.</span>sessionPreset <span class=\"token operator\">=</span> <span class=\"token builtin\">AVCaptureSessionPresetMedium</span>\n\n        <span class=\"token keyword\">let</span> devices <span class=\"token operator\">=</span> <span class=\"token builtin\">AVCaptureDevice</span><span class=\"token punctuation\">.</span><span class=\"token function\">devices</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">for</span> d <span class=\"token keyword\">in</span> devices<span class=\"token operator\">!</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>d <span class=\"token keyword\">as</span> <span class=\"token builtin\">AnyObject</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>position <span class=\"token operator\">==</span> <span class=\"token builtin\">AVCaptureDevicePosition</span><span class=\"token punctuation\">.</span>back<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n                device <span class=\"token operator\">=</span> d <span class=\"token keyword\">as</span><span class=\"token operator\">!</span> <span class=\"token builtin\">AVCaptureDevice</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> device <span class=\"token operator\">==</span> <span class=\"token constant\">nil</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">let</span> myInput<span class=\"token punctuation\">:</span> <span class=\"token builtin\">AVCaptureDeviceInput</span><span class=\"token operator\">?</span>\n            <span class=\"token keyword\">try</span> myInput <span class=\"token operator\">=</span> <span class=\"token function\">AVCaptureDeviceInput</span><span class=\"token punctuation\">(</span>device<span class=\"token punctuation\">:</span> device<span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">if</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">canAddInput</span><span class=\"token punctuation\">(</span>myInput<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                session<span class=\"token punctuation\">.</span><span class=\"token function\">addInput</span><span class=\"token punctuation\">(</span>myInput<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n            <span class=\"token punctuation\">}</span>\n\n            output <span class=\"token operator\">=</span> <span class=\"token function\">AVCaptureVideoDataOutput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            output<span class=\"token punctuation\">.</span>videoSettings <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span> <span class=\"token constant\">kCVPixelBufferPixelFormatTypeKey</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">AnyHashable</span><span class=\"token punctuation\">:</span> <span class=\"token function\">Int</span><span class=\"token punctuation\">(</span>kCVPixelFormatType_32BGRA<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">]</span>\n\n            <span class=\"token keyword\">try</span> device<span class=\"token punctuation\">.</span><span class=\"token function\">lockForConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            device<span class=\"token punctuation\">.</span>activeVideoMinFrameDuration <span class=\"token operator\">=</span> <span class=\"token function\">CMTimeMake</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span>\n            device<span class=\"token punctuation\">.</span><span class=\"token function\">unlockForConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">let</span> queue<span class=\"token punctuation\">:</span> <span class=\"token builtin\">DispatchQueue</span> <span class=\"token operator\">=</span> <span class=\"token function\">DispatchQueue</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">:</span> <span class=\"token string\">\"myqueue\"</span><span class=\"token punctuation\">,</span> attributes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            output<span class=\"token punctuation\">.</span><span class=\"token function\">setSampleBufferDelegate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> queue<span class=\"token punctuation\">:</span> queue<span class=\"token punctuation\">)</span>\n\n            output<span class=\"token punctuation\">.</span>alwaysDiscardsLateVideoFrames <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token keyword\">let</span> error <span class=\"token keyword\">as</span> <span class=\"token builtin\">NSError</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">canAddOutput</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            session<span class=\"token punctuation\">.</span><span class=\"token function\">addOutput</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">for</span> connection <span class=\"token keyword\">in</span> output<span class=\"token punctuation\">.</span>connections <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> conn <span class=\"token operator\">=</span> connection <span class=\"token keyword\">as</span><span class=\"token operator\">?</span> <span class=\"token builtin\">AVCaptureConnection</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> conn<span class=\"token punctuation\">.</span>isVideoOrientationSupported <span class=\"token punctuation\">{</span>\n                    conn<span class=\"token punctuation\">.</span>videoOrientation <span class=\"token operator\">=</span> <span class=\"token builtin\">AVCaptureVideoOrientation</span><span class=\"token punctuation\">.</span>portrait\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">captureOutput</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> captureOutput<span class=\"token punctuation\">:</span> <span class=\"token builtin\">AVCaptureOutput</span><span class=\"token operator\">!</span><span class=\"token punctuation\">,</span> didOutputSampleBuffer sampleBuffer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CMSampleBuffer</span><span class=\"token operator\">!</span><span class=\"token punctuation\">,</span>\n                       from connection<span class=\"token punctuation\">:</span> <span class=\"token builtin\">AVCaptureConnection</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">DispatchQueue</span><span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span><span class=\"token function\">async</span><span class=\"token punctuation\">(</span>execute<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">let</span> image<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIImage</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">CameraUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">imageFromSampleBuffer</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">:</span> sampleBuffer<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>imageView<span class=\"token punctuation\">.</span>image <span class=\"token operator\">=</span> image<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The last method, <code>captureOutput</code> is called in every frames,\nand the argument, <code>sampleBuffer</code> has the data of camera.</p>\n<p>Let’s convert the data to image by creating the follwing util class,\nand show it in <code>imageView</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token comment\">// CameraUtil.swift</span>\n<span class=\"token keyword\">import</span> <span class=\"token builtin\">Foundation</span>\n<span class=\"token keyword\">import</span> <span class=\"token builtin\">UIKit</span>\n<span class=\"token keyword\">import</span> <span class=\"token builtin\">AVFoundation</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CameraUtil</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">func</span> <span class=\"token function\">imageFromSampleBuffer</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CMSampleBuffer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">UIImage</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> pixelBuffer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CVImageBuffer</span> <span class=\"token operator\">=</span> <span class=\"token function\">CMSampleBufferGetImageBuffer</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token operator\">!</span>\n\n        <span class=\"token keyword\">let</span> ciImage <span class=\"token operator\">=</span> <span class=\"token function\">CIImage</span><span class=\"token punctuation\">(</span>cvPixelBuffer<span class=\"token punctuation\">:</span> pixelBuffer<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">let</span> pixelBufferWidth <span class=\"token operator\">=</span> <span class=\"token function\">CGFloat</span><span class=\"token punctuation\">(</span><span class=\"token function\">CVPixelBufferGetWidth</span><span class=\"token punctuation\">(</span>pixelBuffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> pixelBufferHeight <span class=\"token operator\">=</span> <span class=\"token function\">CGFloat</span><span class=\"token punctuation\">(</span><span class=\"token function\">CVPixelBufferGetHeight</span><span class=\"token punctuation\">(</span>pixelBuffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> imageRect<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGRect</span> <span class=\"token operator\">=</span> <span class=\"token function\">CGRectMake</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> pixelBufferWidth<span class=\"token punctuation\">,</span> pixelBufferHeight<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> ciContext <span class=\"token operator\">=</span> <span class=\"token builtin\">CIContext</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> cgimage <span class=\"token operator\">=</span> ciContext<span class=\"token punctuation\">.</span><span class=\"token function\">createCGImage</span><span class=\"token punctuation\">(</span>ciImage<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">:</span> imageRect <span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">let</span> image <span class=\"token operator\">=</span> <span class=\"token function\">UIImage</span><span class=\"token punctuation\">(</span>cgImage<span class=\"token punctuation\">:</span> cgimage<span class=\"token operator\">!</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> image\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">func</span> <span class=\"token function\">CGRectMake</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span><span class=\"token punctuation\">,</span> <span class=\"token number\">_</span> y<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span><span class=\"token punctuation\">,</span> <span class=\"token number\">_</span> width<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span><span class=\"token punctuation\">,</span> <span class=\"token number\">_</span> height<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGFloat</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">CGRect</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> y<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> height<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4><strong>Step 4</strong></h4>\n<p>Let’s check temporarily.</p>\n<p>If the camera image is shown in the image view,\nthen it means it works fine.</p>\n<p>I’ll write the left steps in the next post.</p>","frontmatter":{"title":"How to use OpenCV in Swift (1)","date":"November 06, 2016","tags":["Swift","OpenCV","Xcode"],"ogp":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2016/11/how-to-use-opencv-in-swift","previous":{"fields":{"slug":"/2016/11/inductive-learning"},"frontmatter":{"title":"Inductive Learning","tags":["JavaScript","Machine Learning"]}},"next":{"fields":{"slug":"/2016/11/how-to-use-opencv-in-swift-2"},"frontmatter":{"title":"How to use OpenCV in Swift (2)","tags":["Swift","OpenCV","Xcode"]}}}}}